# WMP (World Model-based Perception) 研究笔记

**论文**: World Model-based Perception for Visual Legged Locomotion  
**会议**: ICRA 2025  
**作者**: Hang Lai, Jiahang Cao, JiaFeng Xu, Hongtao Wu, Yunfeng Lin, Tao Kong, Yong Yu, Weinan Zhang  
**机构**: 上海交通大学 & 字节跳动研究院  
**论文**: https://arxiv.org/abs/2409.16784  
**项目页**: https://wmp-loco.github.io/  
**代码**: https://github.com/bytedance/WMP

---

## 核心贡献

WMP是一个**端到端框架**，受动物认知中心智模型的启发，在A1机器人上实现了**迄今为止最佳的穿越性能**。

---

## 问题背景

### 腿式运动的挑战

- 需要精确感知机器人及其周围环境
- 需要结合本体感知和视觉
- 从高维视觉输入直接学习数据效率低且复杂

### 传统方法的局限

**Teacher-Student框架**：
1. 先学习具有特权信息访问权限的教师策略
2. 再学习学生策略模仿教师行为（使用视觉输入）

**问题**：
- 输入之间的信息差距阻止学生策略达到最优性能
- 学习过程不自然（动物直接基于对世界的理解学习穿越地形，无需特权知识）

---

## WMP方法

### 核心思想

**受自然能力启发**：构建环境的世界模型，基于世界模型学习策略。

### 关键发现

虽然完全在仿真中训练，世界模型能够对**真实世界轨迹做出准确预测**，从而为策略控制器提供信息丰富的信号。

### 技术架构

1. **世界模型构建**：学习环境动力学模型
2. **基于世界模型的策略学习**：直接从世界模型预测中学习控制策略
3. **端到端训练**：无需teacher-student两阶段训练

---

## 实验结果

### 真实世界性能

在A1机器人上实现**最佳穿越性能**，成功穿越多种挑战性地形：

| 地形类型 | 难度参数 | WMP表现 | Baseline表现 |
|---------|---------|---------|-------------|
| **Gap（间隙）** | 85cm | ✅ 成功 | ❌ 失败（80cm） |
| **Climb（攀爬）** | 55cm | ✅ 成功 | ❌ 失败（50cm） |
| **Crawl（爬行）** | 22cm | ✅ 成功 | ❌ 无法处理 |
| **Tilt（倾斜）** | 29cm | ✅ 成功 | ❌ 无法处理 |
| **Stair（楼梯）** | 16cm | ✅ 成功 | ✅ 成功 |
| **Slope（斜坡）** | 27° | ✅ 成功 | ✅ 成功 |

### 仿真性能

更高难度的仿真测试：

| 地形类型 | 难度参数 |
|---------|---------|
| Gap | 90cm |
| Climb | 54cm |
| Crawl | 21cm |
| Tilt | 28cm |
| Stair | 21cm |
| Slope | 30° |

### 控制稳定性

WMP展现出**更稳定的控制行为**，能够穿越更具挑战性的地形。

---

## 技术优势

### vs Baseline (Scandots方法)

**Baseline的局限**：
- 在Gap和Climb的困难级别失败
- 由于scandots的限制，无法处理Crawl和Tilt等地形

**WMP的优势**：
1. **更强的穿越能力**：成功率更高，能处理更多地形类型
2. **更高的鲁棒性**：控制更稳定
3. **端到端学习**：无需特权信息，学习过程更自然
4. **Sim2Real能力**：仿真训练的世界模型能准确预测真实世界

---

## 关键洞察

1. **世界模型的迁移能力**：仿真训练的世界模型能够泛化到真实世界
2. **认知启发的设计**：模仿动物的心智模型是有效的
3. **端到端优于两阶段**：直接从世界模型学习优于teacher-student框架
4. **信息完整性**：世界模型保留了完整的环境信息，避免了信息差距

---

## 对具身智能的意义

1. **视觉腿式运动突破**：为视觉引导的腿式运动提供新范式
2. **Sim2Real新思路**：通过世界模型实现有效的仿真到现实迁移
3. **端到端学习**：简化训练流程，提升最终性能
4. **实用性验证**：在真实A1机器人上的成功验证了方法的实用价值

---

## 技术细节补充

### 世界模型的作用

- **预测未来状态**：基于当前观察和动作预测未来轨迹
- **提供信息信号**：为策略控制器提供丰富的环境理解
- **跨越Sim2Real鸿沟**：仿真训练但能准确预测真实世界

### 与DreamerV3的关系

WMP可能基于或借鉴了DreamerV3的世界模型架构，但专注于腿式运动的特定应用场景。

---

## 未来方向

1. 更复杂的户外地形
2. 动态障碍物处理
3. 多机器人协同
4. 与大模型结合实现语言引导的运动控制
